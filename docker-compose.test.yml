services:
  latex:
    build: .
    command: make start
    ports:
     - "9898:8080"
    volumes:
     - .:/app/latex-on-http
    environment:
      CACHE_HOST: cache
      KEEP_WORKSPACE_DIR_ON_ERROR: 1
      GOOSE_DBSTRING: postgres://latexonhttp:latexdev@postgres_db:5432/latexonhttp
  cache:
    build:
      context: .
      dockerfile: cache.Dockerfile
    command: make start-cache
    volumes:
     - .:/app/latex-on-http
  postgres_db:
    image: docker.io/postgres:17
    environment:
      POSTGRES_USER: latexonhttp
      POSTGRES_PASSWORD: latexdev
      POSTGRES_DB: latexonhttp
    volumes:
      - ./data/postgres_test:/var/lib/postgresql/data
